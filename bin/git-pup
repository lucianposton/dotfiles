#!/bin/bash

git pull --ff-only && \
    git submodule update --recursive --init "$@" && \
    git submodule foreach -q --recursive 'branch="$(git config -f $toplevel/.gitmodules submodule.$name.branch)"; git checkout "$branch"' && \
    git submodule status --recursive
